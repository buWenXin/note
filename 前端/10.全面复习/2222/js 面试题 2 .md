

#### JavaScript的运行机制

- **JavaScript为什么是单线程的?**
    - JavaScript是门专门为浏览器设计的脚本语义,它的主要用途就是与用户互动,和操作dom,这就决定了它只能是一门脚本语言,如果JavaScript是多线程的话,那么问题就严重,假设JavaScript有两个线程,一个线程在某个Dom节点上添加内容,另一个则对这个dom进行删除,那么浏览器到底听谁的?
- **JavaScript中的任务队列**
    - JavaScript中有两个队列 宏任务队列 为任何队列 ,都是由事件线程管理的
    - 宏仁队列, JavaScript中的定时器, ajax请求  浏览器事件 都是宏任务队列
    - 微任何队列
    - 事件循环 , 即 JavaScript在执行完 执行栈中的任务呢的时候,就会去看微任务队列中有没有需要执行的任务,如何有就执行微任何队列中的任务,直到微任中的任务都被执行完,才会去看宏任务队列中有没有任务需要执行,有就执行,没有就介绍本次循环,叫由渲染线程执行
- 浏览器中的线程
    - js引擎线程    js引擎线程和渲染线程是相互排斥的,当js线程执行的时候,渲染线程就会被冻结
    - 渲染线程
    - 事件线程
        - 管理事件循环 ,维护宏任务和微任务队列
    - Ajax线程
        - 发生请求,当请求有相应时,将相应的回调函数推人到宏任务队列中
    - 定时器线程
- 















- js中的异步任务
    - JavaScript在运行的时候,碰到异步任务,不必等待结果,而把它送人到任务队列中, 继续执行其他同步任务,等待



- 所有的同步任务都在主线程上执行 , 全局代码也是一个同步任务 , 形成一个执行栈
- 主线程之外还有一个任务队列







- 浏览器的运行机制
    - 浏览器的渲染引擎
        -  js引擎线程 
            - 执行栈
        - 渲染线程  
        - 定时器线程  
        - 事件触发线程
            - 维护事件循环 消息队列
            - 监听事件,当事件发生后,就会向消息队列中添加一条信息
        - ajax线程
- JavaScript的运行机制
    - 任务队列
    - 事件循环
        - 
    - 消息队列
    - 微任务
    - 宏任务

 

js代码执行 ==>遇到异步任务 == 通知相应的线程执行异步任务 线程执行完异步任务,通知事件线程 ,事件线程将异步任务的回调加入到消息队列中, js引擎从消息队列中获取事件回调,将回调放入执行栈中执行 