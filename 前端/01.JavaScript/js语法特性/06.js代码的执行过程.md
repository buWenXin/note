

## 1 JS编译

JS不是提前编译的，而是在执行前由JS引擎在几微秒内进行编译
 编译三部：
 1、词法分析 （分析有啥词并整理成词法单元流（由词构成的数组））
 2、语法分析（词法单元流整理成抽象语法树（abstract syntax code，AST））
 3、代码生成（树整理成机器指令，等待执行）
 JS在整个编译过程中的语法分析和代码生成阶段有特定步骤对运行性能进行优化。如：对冗余元素优化等。
 这就是JS被称之为动态语言的原因







## 二 JS代码执行过程：

1. 引擎编译JS代码
2. 主线程顺序执行编译后的JS代码
3. 栈内执行上下文遵循先进后出规则（FILO）。全局执行上下文进栈后，直到程序关闭才会销毁。
    JS主线程在执行栈中从上到下执行栈内代码，遇到存在作用域的代码块，会向执行栈中添加对应的执行上下文，进入这个执行上下文继续执行代码，执行完毕后会销毁对应的执行上下文，直到同步代码执行完毕。（执行上下文可能存放到了存储引用类型的栈内）
4. 当遇到异步任务时，将异步任务的回调函数放入到**事件队列**中，继续执行代码；在此过程中回调函数如果引用了函数外作用域内的变量，会将此函数，会形成闭包。
5. 当执行栈中的代码执行完毕后，去**事件队列**中检查是否有可执行的回调函数，存在，将回调函数放入执行栈。这个检查会循环执行，而这个循环检查就是**事件循环**。

tips：异步任务，例如：定时器、ajax、promise、DOM事件。



