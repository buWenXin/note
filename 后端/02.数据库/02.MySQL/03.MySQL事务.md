# MySQL事务

>      一个事务其实就是一个完整的业务逻辑。是一个最小的工作单元。 事务处理可以用来维护数据库的*完整性*，保证成批的 [SQL 语句要么全部执行，要么全部不执行。保证了数据的安全性，一致性！]()
>
>      事务用来管理 insert,update,delete 语句。本质上，一个事务其实就是多条DML语句同时成功，或者同时失败！
>
>      ```js
>      什么是一个完整的业务逻辑？
>      	假设转账，从A账户向B账户中转账10000.
>      	将A账户的钱减去10000（update语句）
>      	将B账户的钱加上10000（update语句）
>      	这就是一个完整的业务逻辑。
>      
>      	以上的操作是一个最小的工作单元，要么同时成功，要么同时失败，不可再分。
>      	这两个update语句要求必须同时成功或者同时失败，这样才能保证钱是正确的。
>      ```

## 1. 数据库事务介绍

- **事务：一组逻辑操作单元,使数据从一种状态变换到另一种状态。**

- **事务处理（事务操作）：**保证所有事务都作为一个工作单元来执行，即使出现了故障，都不能改变这种执行方式。当在一个事务中执行多个操作时，要么所有的事务都**被提交(commit)**，那么这些修改就永久地保存下来；要么数据库管理系统将放弃所作的所有修改，整个事务**回滚(rollback)**到最初状态。

- 为确保数据库中数据的**一致性**，数据的操纵应当是离散的成组的逻辑单元：当它全部完成时，数据的一致性可以保持，而当这个单元中的一部分操作失败，整个事务应全部视为错误，所有从起始点以后的操作应全部回退到开始状态。 

## 2.事务四大特征

>  一般来说，事务是必须满足4个条件（ACID）：：原子性（Atomicity，或称不可分割性）、一致性（Consistency）、隔离性（Isolation，又称独立性）、持久性（Durability）。
>

- **原子性：**
  -   一个事务（transaction）中的所有操作，要么全部完成，要么全部不完成，不会结束在中间某个环节。事务在执行过程中发生错误，会被回滚（Rollback）到事务开始前的状态，就像这个事务从来没有执行过一样。
- **一致性：**
  - 在事务开始之前和事务结束以后，数据库的完整性没有被破坏。这表示写入的资料必须完全符合所有的预设规则，这包含资料的精确度、串联性以及后续数据库可以自发性地完成预定的工作。(比如：A向B转账，不可能A扣了钱，B却没有收到)
- **隔离性：**
  -   数据库允许多个并发事务同时对其数据进行读写和修改的能力，隔离性可以防止多个事务并发执行时由于交叉执行而导致数据的不一致。事务隔离分为不同级别，包括读未提交（Read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（Serializable）。（比u人：A正在从一张银行卡里面取钱，在A取钱的过程中，B不能向这张银行卡打钱）
- **持久性：**
  - 事务处理结束后，对数据的修改就是永久的，即便系统故障也不会丢失。

## 3.事务提交、回滚

